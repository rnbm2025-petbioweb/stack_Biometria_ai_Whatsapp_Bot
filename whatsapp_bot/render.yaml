services:
  - type: web
    name: whatsapp-bot
    env: node
    plan: free
    rootDir: whatsapp_bot
    buildCommand: |
      yarn install
      node fix-puppeteer.js
    startCommand: node index.js
    envVars:
      # ===============================
      # ‚öôÔ∏è Node / App
      # ===============================
      - key: NODE_ENV
        value: production
      - key: PORT
        value: "3000"
      - key: PUPPETEER_SKIP_CHROMIUM_DOWNLOAD
        value: "true"
      - key: PUPPETEER_EXECUTABLE_PATH
        value: /opt/render/.cache/puppeteer/chrome/linux-120.0.6099.109/chrome-linux64/chrome

      # ===============================
      # üì≤ WhatsApp / Twilio
      # ===============================
      - key: ADMIN_NUMBER
        value: whatsapp:+573007019277
      - key: TWILIO_SID
        value: ACe15576d5f4212f1aa78999a3f53820d1
      - key: TWILIO_AUTH
        value: f462e76653a85ac6172d441a7bd67332
      - key: TWILIO_NUMBER
        value: whatsapp:+14155238886

      # ===============================
      # ü§ñ OpenAI
      # ===============================
      - key: OPENAI_API_KEY
        value: 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

      # ===============================
      # üêò Supabase
      # ===============================
      - key: SUPABASE_URL
        value: https://jbsxvonnrahhfffeacdy.supabase.co
      - key: SUPABASE_KEY
        value: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

      # ===============================
      # üê¨ MySQL
      # ===============================
      - key: MYSQL_HOST
        value: 172.22.0.2
      - key: MYSQL_PORT
        value: "3306"
      - key: MYSQL_USER
        value: root
      - key: MYSQL_PASSWORD
        value: R00t_Segura_2025!
      - key: MYSQL_DATABASE
        value: db__produccion_petbio_segura_2025

      # ===============================
      # ‚òÅÔ∏è MQTT Cloud (CloudMQTT)
      # ===============================
      - key: MQTT_CLOUD_BROKER
        value: mqtts://duck-01.lmq.cloudamqp.com:8883
      - key: MQTT_CLOUD_USER
        value: xdagoqsj
      - key: MQTT_CLOUD_PASS
        value: flwvAT0Npo8piPIZehUr_PnKPrs1JJ8L

      # ===============================
      # üîó PHP Integrator
      # ===============================
      - key: CATALOG_URL
        value: http://php_integrator/catalogos.php
      - key: SUSCRIPCION_URL
        value: http://php_integrator/whatsapp-suscripcion.php
